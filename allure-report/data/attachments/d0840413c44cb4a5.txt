[12/05/25 14:28:16] INFO     Python version: 3.13.9 (main, Nov 18 2025, 05:57:28) [GCC 12.2.0]                                                                                 
                    INFO     Torch version: 2.8.0+cpu                                                                                                                          
                    INFO     CUDA version: None                                                                                                                                
                    INFO     Training with 1 devices                                                                                                                           
                    INFO     Per-device batch size: 32                                                                                                                         
                    INFO     Gradient accumulation steps: 1                                                                                                                    
                    INFO     Effective batch size: 32                                                                                                                          
                    INFO     Using device: cpu                                                                                                                                 
                    INFO     Config:                                                                                                                                           
                             run_name: instanovoplus_unit_test                                                                                                                 
                             tags:                                                                                                                                             
                             - diffusion                                                                                                                                       
                             tb_summarywriter: ./logs/instanovo/instanovoplus-unit-test                                                                                        
                             seed: 101                                                                                                                                         
                             warmup_iters: 480                                                                                                                                 
                             learning_rate: 0.001                                                                                                                              
                             weight_decay: 0.0                                                                                                                                 
                             train_batch_size: 32                                                                                                                              
                             grad_accumulation: 1                                                                                                                              
                             gradient_clip_val: 10.0                                                                                                                           
                             predict_batch_size: 128                                                                                                                           
                             lr_scheduler: cosine                                                                                                                              
                             num_workers: 4                                                                                                                                    
                             pin_memory: true                                                                                                                                  
                             prefetch_factor: null                                                                                                                             
                             compile_model: true                                                                                                                               
                             fp16: true                                                                                                                                        
                             force_cpu: true                                                                                                                                   
                             mps: false                                                                                                                                        
                             force_fp32: false                                                                                                                                 
                             training_steps: 41                                                                                                                                
                             num_sanity_val_steps: 10                                                                                                                          
                             console_logging_steps: 50                                                                                                                         
                             tensorboard_logging_steps: 500                                                                                                                    
                             use_neptune: false                                                                                                                                
                             enable_verbose_logging: false                                                                                                                     
                             enable_verbose_accelerate: true                                                                                                                   
                             enable_verbose_s3: true                                                                                                                           
                             train_subset: 1.0                                                                                                                                 
                             valid_subset: 1.0                                                                                                                                 
                             validation_interval: 100000                                                                                                                       
                             save_model: true                                                                                                                                  
                             model_save_folder_path: tests/instanovo_test_resources/diffusion_train_test                                                                       
                             save_weights_only: false                                                                                                                          
                             checkpoint_interval: 40                                                                                                                           
                             resume_accelerator_state: null                                                                                                                    
                             resume_checkpoint_path: null                                                                                                                      
                             model:                                                                                                                                            
                               vocab_size: 8                                                                                                                                   
                               layers: 6                                                                                                                                       
                               dim: 320                                                                                                                                        
                               nheads: 20                                                                                                                                      
                               dropout: 0.1                                                                                                                                    
                               attention_type: wavlm                                                                                                                           
                               time_steps: 200                                                                                                                                 
                               wav_encoder: wavlm                                                                                                                              
                               wavlm_num_bucket: 140                                                                                                                           
                               wavlm_max_dist: 280                                                                                                                             
                               dim_feedforward: 1280                                                                                                                           
                               max_charge: 3                                                                                                                                   
                               t_emb_dim: 320                                                                                                                                  
                               t_emb_max_period: 10000                                                                                                                         
                               cond_emb_dim: 320                                                                                                                               
                               drop_cond_prob: 0.1                                                                                                                             
                               cond_cross_attn_layers:                                                                                                                         
                               - 0                                                                                                                                             
                               - 2                                                                                                                                             
                               - 4                                                                                                                                             
                               conv_pos: 256                                                                                                                                   
                               conv_pos_groups: 32                                                                                                                             
                               diffusion_type: multinomial                                                                                                                     
                               diffusion_s: 0.008                                                                                                                              
                               pos_encoding: relative                                                                                                                          
                               use_flash_attention: false                                                                                                                      
                               conv_peak_encoder: false                                                                                                                        
                               n_peaks: 11                                                                                                                                     
                               min_mz: 1.0                                                                                                                                     
                               max_mz: 1000.0                                                                                                                                  
                               min_intensity: 0.01                                                                                                                             
                               remove_precursor_tol: 2.0                                                                                                                       
                               precursor_mass_tol: 50                                                                                                                          
                               isotope_error_range:                                                                                                                            
                               - 0                                                                                                                                             
                               - 1                                                                                                                                             
                               max_length: 6                                                                                                                                   
                               peak_embedding_dtype: float64                                                                                                                   
                             dataset:                                                                                                                                          
                               train_path: ./tests/instanovo_test_resources/example_data/train.mgf                                                                             
                               valid_path: ./tests/instanovo_test_resources/example_data/valid.mgf                                                                             
                               valid_subset_of_train: null                                                                                                                     
                               residue_remapping: {}                                                                                                                           
                             residues:                                                                                                                                         
                               residues:                                                                                                                                       
                                 A: 10.5                                                                                                                                       
                                 B: 20.75                                                                                                                                      
                                 C: 15.68                                                                                                                                      
                                 D: 18.25                                                                                                                                      
                                 E: 12.33                                                                                                                                      
                             validate_before_training: false                                                                                                                   
                             keep_model_every_interval: false                                                                                                                  
                             save_accelerator_state: false                                                                                                                     
                             keep_accelerator_every_interval: null                                                                                                             
                             checkpoint_metric: null                                                                                                                           
                             checkpoint_metric_mode: null                                                                                                                      
                                                                                                                                                                               
                    INFO     Vocab: {0: '[PAD]', 1: '[SOS]', 2: '[EOS]', 3: 'A', 4: 'B', 5: 'C', 6: 'D', 7: 'E'}                                                               
                    INFO     Loading training dataset...                                                                                                                       
                    INFO     Loading file 001 of 001: ./tests/instanovo_test_resources/example_data/train.mgf                                                                  
[12/05/25 14:28:22] INFO     Saving temporary file to /tmp/tmp6wy9ue9o/temp_028fa600876343e8874416a0cf8bba81.parquet                                                           
                    INFO     Verifying loaded data                                                                                                                             
                    INFO     Loading validation dataset...                                                                                                                     
                    INFO     Loading file 001 of 001: ./tests/instanovo_test_resources/example_data/valid.mgf                                                                  
                    INFO     Saving temporary file to /tmp/tmpw2vdl0yr/temp_e291c716aeb142a28246b2a7abf21d47.parquet                                                           
                    INFO     Verifying loaded data                                                                                                                             
                    INFO     HTTP Request: HEAD https://s3.amazonaws.com/datasets.huggingface.co/datasets/datasets/parquet/parquet.py "HTTP/1.1 404 Not Found"                 
                    INFO     Checking for unknown residues in 17,437 rows.                                                                                                     
[12/05/25 14:28:23] INFO     Checking charge values...                                                                                                                         
                    INFO     Data loaded from 15,500 training samples and 1,937 validation samples (unfiltered values)                                                         
[12/05/25 14:28:24] INFO     Data loaders built                                                                                                                                
                    INFO     Sample batch:                                                                                                                                     
                    INFO      - spectra: torch.float32, torch.Size([32, 10, 2])                                                                                                
                    INFO      - precursors: torch.float32, torch.Size([32, 3])                                                                                                 
                    INFO      - spectra_mask: torch.bool, torch.Size([32, 10])                                                                                                 
                    INFO      - peptides: torch.int64, torch.Size([32, 6])                                                                                                     
                    INFO      - peptides_mask: torch.bool, torch.Size([32, 6])                                                                                                 
                    INFO     Setting up model...                                                                                                                               
                    INFO     Model has 19,124,172 parameters                                                                                                                   
                    INFO     TensorBoard logs will be saved to ./logs/instanovo/instanovoplus-unit-testinstanovoplus_unit_test_25_12_05_14_28                                  
                    INFO     Training setup complete.                                                                                                                          
                    INFO      - Steps per validation: 100,000                                                                                                                  
                    INFO      - Steps per checkpoint: 40                                                                                                                       
                    INFO      - Total training steps: 41                                                                                                                       
                    INFO     Estimating steps per epoch based on unfiltered training set size:                                                                                 
                    INFO      - Estimated steps per epoch: 484                                                                                                                 
                    INFO      - Estimated total epochs: 0.1                                                                                                                    
                    WARNING  Total steps is less than estimated steps per epoch, this may result in less than one epoch during training                                        
