INFO     instanovo.common.predictor:predictor.py:322 Python version: 3.13.9 (main, Nov 18 2025, 05:57:28) [GCC 12.2.0]
INFO     instanovo.common.predictor:predictor.py:323 Torch version: 2.8.0+cpu
INFO     instanovo.common.predictor:predictor.py:324 CUDA version: None
INFO     instanovo.common.predictor:predictor.py:325 Predicting with 1 devices
INFO     instanovo.common.predictor:predictor.py:326 Per-device batch size: 32
INFO     instanovo.common.predictor:predictor.py:328 Using device: cpu
INFO     instanovo.common.predictor:predictor.py:89 Config:
data_path: tests/instanovo_test_resources/example_data/test_sample.mgf
instanovo_plus_model: tests/instanovo_test_resources/instanovoplus/model_latest.ckpt
output_path: tests/instanovo_test_resources/instanovoplus/test_sample_preds.csv
knapsack_path: null
data_type: null
denovo: false
max_length: 6
max_charge: 3
isotope_error_range:
- 0
- 1
subset: 1
refine: false
refinement_path: null
prediction_refine_col: predictions_tokenised
prediction_confidence_col: log_probs
refinement_id_col: spectrum_id
dataset_id_col: spectrum_id
refine_all: false
refine_threshold: 0.9
prediction_tokenised_col: predictions_tokenised
prediction_col: predictions
log_probs_col: log_probs
token_log_probs_col: token_log_probs
num_workers: 4
batch_size: 32
device: auto
fp16: true
force_cpu: true
mps: false
force_fp32: false
log_interval: 50
use_basic_logging: true
filter_precursor_ppm: 20
filter_confidence: 0.0001
filter_fdr_threshold: 0.05
residue_remapping:
  M(ox): M(+15.99)
  S(p): S(+79.97)
  T(p): T(+79.97)
  Y(p): Y(+79.97)
  Q(+0.98): Q(+.98)
  N(+0.98): N(+.98)
column_map:
  Modified sequence: modified_sequence
  MS/MS m/z: precursor_mz
  Mass: precursor_mass
  Charge: precursor_charge
  Mass values: mz_array
  Mass spectrum: mz_array
  Intensity: intensity_array
  Raw intensity spectrum: intensity_array
index_columns:
- id
- experiment_name
- evidence_index
- scan_number
- spectrum_id
- global_index
- spectrum_index
- file_index
- sample
- file
- index
- fileno
- precursor_mz
- precursor_charge
instanovo_predictions_path: null
pred_tok_col: predictions_tokenised
pred_col: predictions
instanovo_id_col: scan_number
instanovoplus_id_col: scan_number

INFO     instanovo.common.predictor:predictor.py:98 Loading model...
INFO     instanovo.diffusion.predict:predict.py:51 Loading InstaNovo+ model tests/instanovo_test_resources/instanovoplus/model_latest.ckpt
INFO     instanovo.common.predictor:predictor.py:103 Model loaded.
INFO     instanovo.common.predictor:predictor.py:107 Vocab: {0: '[PAD]', 1: '[SOS]', 2: '[EOS]', 3: 'A', 4: 'B', 5: 'C', 6: 'D', 7: 'E'}
INFO     instanovo.common.predictor:predictor.py:109 Loading dataset...
INFO     instanovo.common.predictor:predictor.py:187 Loading data from tests/instanovo_test_resources/example_data/test_sample.mgf
INFO     instanovo.common.predictor:predictor.py:112 Data loaded: 1 test samples.
INFO     instanovo.common.predictor:predictor.py:115 Data loader built.
INFO     instanovo.common.predictor:predictor.py:289 Sample batch:
INFO     instanovo.common.predictor:predictor.py:298  - spectra: torch.float32, torch.Size([1, 3, 2])
INFO     instanovo.common.predictor:predictor.py:298  - precursors: torch.float32, torch.Size([1, 3])
INFO     instanovo.common.predictor:predictor.py:298  - spectra_mask: torch.bool, torch.Size([1, 3])
INFO     instanovo.common.predictor:predictor.py:298  - peptides: torch.int64, torch.Size([1, 6])
INFO     instanovo.common.predictor:predictor.py:298  - peptides_mask: torch.bool, torch.Size([1, 6])
INFO     instanovo.common.predictor:predictor.py:298  - group: <class 'list'>, 1
INFO     instanovo.common.predictor:predictor.py:298  - prediction_id: <class 'list'>, 1
INFO     instanovo.common.predictor:predictor.py:120 Initializing decoder.
INFO     instanovo.common.predictor:predictor.py:123 Initializing metrics.
INFO     instanovo.common.predictor:predictor.py:132 Total batches: 1
INFO     instanovo.common.predictor:predictor.py:360 Predicting...
INFO     instanovo.common.predictor:predictor.py:365 Batch 0 shape: 1
INFO     instanovo.common.predictor:predictor.py:400 [Batch 00001/00001] [00:00:02/00:00:00] 2.55 s/step: 
INFO     instanovo.common.predictor:predictor.py:406 Time taken for tests/instanovo_test_resources/example_data/test_sample.mgf is 2.5 seconds
INFO     instanovo.common.predictor:predictor.py:408 Prediction complete.
INFO     instanovo.common.predictor:predictor.py:427 Calculating metrics...
INFO     instanovo.common.predictor:predictor.py:533 Performance:
INFO     instanovo.common.predictor:predictor.py:534   aa_er       0.75000
INFO     instanovo.common.predictor:predictor.py:535   aa_prec     0.00000
INFO     instanovo.common.predictor:predictor.py:536   aa_recall   0.00000
INFO     instanovo.common.predictor:predictor.py:537   pep_prec    0.00000
INFO     instanovo.common.predictor:predictor.py:538   pep_recall  0.00000
INFO     instanovo.common.predictor:predictor.py:539   auc         0.00000
INFO     instanovo.common.predictor:predictor.py:555 Performance at 5.0% FDR:
INFO     instanovo.common.predictor:predictor.py:556   aa_prec     1.00000
INFO     instanovo.common.predictor:predictor.py:557   aa_recall   0.00000
INFO     instanovo.common.predictor:predictor.py:558   pep_prec    1.00000
INFO     instanovo.common.predictor:predictor.py:559   pep_recall  0.00000
INFO     instanovo.common.predictor:predictor.py:560   confidence  1.00000
INFO     instanovo.common.predictor:predictor.py:565 Performance with filtering at 20 ppm delta mass:
INFO     instanovo.common.predictor:predictor.py:578 No predictions met criteria, skipping metrics.
INFO     instanovo.common.predictor:predictor.py:583 Performance with filtering confidence < 0.0001
INFO     instanovo.common.predictor:predictor.py:588   aa_prec     0.00000
INFO     instanovo.common.predictor:predictor.py:589   aa_recall   0.00000
INFO     instanovo.common.predictor:predictor.py:590   pep_prec    0.00000
INFO     instanovo.common.predictor:predictor.py:591   pep_recall  0.00000
INFO     instanovo.common.predictor:predictor.py:592 Rows filtered: 0 (0.00%)
INFO     instanovo.common.predictor:predictor.py:594 Metrics calculated on a small number of samples (1), interpret with care!
INFO     instanovo.common.predictor:predictor.py:683 Saving predictions to tests/instanovo_test_resources/instanovoplus/test_sample_preds.csv.
INFO     instanovo.common.predictor:predictor.py:685 Predictions saved to tests/instanovo_test_resources/instanovoplus/test_sample_preds.csv