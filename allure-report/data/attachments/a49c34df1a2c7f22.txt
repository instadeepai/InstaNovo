                    INFO     Python version: 3.13.9 (main, Nov 18 2025, 05:57:28) [GCC 12.2.0]                                                                                 
                    INFO     Torch version: 2.8.0+cpu                                                                                                                          
                    INFO     CUDA version: None                                                                                                                                
                    INFO     Training with 1 devices                                                                                                                           
                    INFO     Per-device batch size: 32                                                                                                                         
                    INFO     Gradient accumulation steps: 1                                                                                                                    
                    INFO     Effective batch size: 32                                                                                                                          
                    INFO     Using device: cpu                                                                                                                                 
                    INFO     Config:                                                                                                                                           
                             run_name: instanovo_unit_test                                                                                                                     
                             tags:                                                                                                                                             
                             - default                                                                                                                                         
                             tb_summarywriter: ./logs/instanovo/instanovo-unit-test                                                                                            
                             seed: 101                                                                                                                                         
                             warmup_iters: 480                                                                                                                                 
                             learning_rate: 0.001                                                                                                                              
                             weight_decay: 0.0                                                                                                                                 
                             train_batch_size: 32                                                                                                                              
                             grad_accumulation: 1                                                                                                                              
                             gradient_clip_val: 10.0                                                                                                                           
                             predict_batch_size: 128                                                                                                                           
                             lr_scheduler: cosine                                                                                                                              
                             num_workers: 4                                                                                                                                    
                             pin_memory: false                                                                                                                                 
                             prefetch_factor: null                                                                                                                             
                             use_shuffle_buffer: true                                                                                                                          
                             shuffle_buffer_size: 100000                                                                                                                       
                             compile_model: true                                                                                                                               
                             force_cpu: true                                                                                                                                   
                             fp16: true                                                                                                                                        
                             mps: false                                                                                                                                        
                             force_fp32: false                                                                                                                                 
                             training_steps: 481                                                                                                                               
                             num_sanity_val_steps: 10                                                                                                                          
                             validate_before_training: false                                                                                                                   
                             console_logging_steps: 50                                                                                                                         
                             tensorboard_logging_steps: 500                                                                                                                    
                             use_neptune: false                                                                                                                                
                             enable_verbose_logging: false                                                                                                                     
                             enable_verbose_accelerate: true                                                                                                                   
                             enable_verbose_s3: true                                                                                                                           
                             train_subset: 1.0                                                                                                                                 
                             valid_subset: 1.0                                                                                                                                 
                             validation_interval: 100000                                                                                                                       
                             save_model: true                                                                                                                                  
                             keep_model_every_interval: false                                                                                                                  
                             save_accelerator_state: false                                                                                                                     
                             keep_accelerator_every_interval: null                                                                                                             
                             model_save_folder_path: tests/instanovo_test_resources/train_test                                                                                 
                             checkpoint_interval: 480                                                                                                                          
                             checkpoint_metric: null                                                                                                                           
                             checkpoint_metric_mode: null                                                                                                                      
                             resume_accelerator_state: null                                                                                                                    
                             resume_checkpoint_path: null                                                                                                                      
                             model:                                                                                                                                            
                               dim_model: 320                                                                                                                                  
                               n_head: 20                                                                                                                                      
                               dim_feedforward: 1280                                                                                                                           
                               encoder_layers: 9                                                                                                                               
                               decoder_layers: 9                                                                                                                               
                               dropout: 0.0                                                                                                                                    
                               use_flash_attention: false                                                                                                                      
                               conv_peak_encoder: false                                                                                                                        
                               n_peaks: 11                                                                                                                                     
                               min_mz: 1.0                                                                                                                                     
                               max_mz: 1000.0                                                                                                                                  
                               min_intensity: 0.01                                                                                                                             
                               remove_precursor_tol: 2.0                                                                                                                       
                               max_charge: 3                                                                                                                                   
                               precursor_mass_tol: 50                                                                                                                          
                               isotope_error_range:                                                                                                                            
                               - 0                                                                                                                                             
                               - 1                                                                                                                                             
                               max_length: 6                                                                                                                                   
                               peak_embedding_dtype: float64                                                                                                                   
                               n_layers: 6                                                                                                                                     
                             dataset:                                                                                                                                          
                               train_path: ./tests/instanovo_test_resources/example_data/train.mgf                                                                             
                               valid_path: null                                                                                                                                
                               valid_subset_of_train: null                                                                                                                     
                               residue_remapping: {}                                                                                                                           
                             residues:                                                                                                                                         
                               residues:                                                                                                                                       
                                 A: 10.5                                                                                                                                       
                                 B: 20.75                                                                                                                                      
                                 C: 15.68                                                                                                                                      
                                 D: 18.25                                                                                                                                      
                                 E: 12.33                                                                                                                                      
                                                                                                                                                                               
                    INFO     Vocab: {0: '[PAD]', 1: '[SOS]', 2: '[EOS]', 3: 'A', 4: 'B', 5: 'C', 6: 'D', 7: 'E'}                                                               
                    INFO     Loading training dataset...                                                                                                                       
                    INFO     Loading file 001 of 001: ./tests/instanovo_test_resources/example_data/train.mgf                                                                  
[12/05/25 14:27:44] INFO     Saving temporary file to /tmp/tmpgv0ntu6w/temp_9970bbf08f4b43beae0891c61714cbac.parquet                                                           
                    INFO     Verifying loaded data                                                                                                                             
                    INFO     Loading validation dataset...                                                                                                                     
                    INFO     Loading file 001 of 001: ./tests/instanovo_test_resources/example_data/train.mgf                                                                  
[12/05/25 14:27:49] INFO     Saving temporary file to /tmp/tmprxxy00ig/temp_ff6ac9d5c3aa4cdea9705f81cc9e0e89.parquet                                                           
                    INFO     Verifying loaded data                                                                                                                             
                    INFO     Validation path not specified, generating from training set.                                                                                      
[12/05/25 14:27:50] INFO     Data splits saved to tests/instanovo_test_resources/train_test/splits.csv                                                                         
                    INFO     HTTP Request: HEAD https://s3.amazonaws.com/datasets.huggingface.co/datasets/datasets/parquet/parquet.py "HTTP/1.1 404 Not Found"                 
                    INFO     Checking for unknown residues in 15,500 rows.                                                                                                     
                    INFO     Checking charge values...                                                                                                                         
                    INFO     Data loaded from 11,625 training samples and 3,875 validation samples (unfiltered values)                                                         
[12/05/25 14:27:52] INFO     Data loaders built                                                                                                                                
[12/05/25 14:27:53] INFO     Sample batch:                                                                                                                                     
                    INFO      - spectra: torch.float32, torch.Size([32, 10, 2])                                                                                                
                    INFO      - precursors: torch.float32, torch.Size([32, 3])                                                                                                 
                    INFO      - spectra_mask: torch.bool, torch.Size([32, 10])                                                                                                 
                    INFO      - peptides: torch.int64, torch.Size([32, 7])                                                                                                     
                    INFO      - peptides_mask: torch.bool, torch.Size([32, 7])                                                                                                 
                    INFO     Setting up model...                                                                                                                               
                    INFO     Model has 26,314,568 parameters                                                                                                                   
[12/05/25 14:27:54] INFO     TensorBoard logs will be saved to ./logs/instanovo/instanovo-unit-testinstanovo_unit_test_25_12_05_14_27                                          
                    INFO     Training setup complete.                                                                                                                          
                    INFO      - Steps per validation: 100,000                                                                                                                  
                    INFO      - Steps per checkpoint: 480                                                                                                                      
                    INFO      - Total training steps: 481                                                                                                                      
                    INFO     Estimating steps per epoch based on unfiltered training set size:                                                                                 
                    INFO      - Estimated steps per epoch: 363                                                                                                                 
                    INFO      - Estimated total epochs: 1.3                                                                                                                    
                    INFO     Python version: 3.13.9 (main, Nov 18 2025, 05:57:28) [GCC 12.2.0]                                                                                 
                    INFO     Torch version: 2.8.0+cpu                                                                                                                          
                    INFO     CUDA version: None                                                                                                                                
                    INFO     Training with 1 devices                                                                                                                           
                    INFO     Per-device batch size: 32                                                                                                                         
                    INFO     Gradient accumulation steps: 1                                                                                                                    
                    INFO     Effective batch size: 32                                                                                                                          
                    INFO     Using device: cpu                                                                                                                                 
                    INFO     Config:                                                                                                                                           
                             run_name: instanovo_unit_test                                                                                                                     
                             tags:                                                                                                                                             
                             - default                                                                                                                                         
                             tb_summarywriter: ./logs/instanovo/instanovo-unit-test                                                                                            
                             seed: 101                                                                                                                                         
                             warmup_iters: 480                                                                                                                                 
                             learning_rate: 0.001                                                                                                                              
                             weight_decay: 0.0                                                                                                                                 
                             train_batch_size: 32                                                                                                                              
                             grad_accumulation: 1                                                                                                                              
                             gradient_clip_val: 10.0                                                                                                                           
                             predict_batch_size: 128                                                                                                                           
                             lr_scheduler: cosine                                                                                                                              
                             num_workers: 4                                                                                                                                    
                             pin_memory: false                                                                                                                                 
                             prefetch_factor: null                                                                                                                             
                             use_shuffle_buffer: true                                                                                                                          
                             shuffle_buffer_size: 100000                                                                                                                       
                             compile_model: true                                                                                                                               
                             force_cpu: true                                                                                                                                   
                             fp16: true                                                                                                                                        
                             mps: false                                                                                                                                        
                             force_fp32: false                                                                                                                                 
                             training_steps: 481                                                                                                                               
                             num_sanity_val_steps: 10                                                                                                                          
                             validate_before_training: false                                                                                                                   
                             console_logging_steps: 50                                                                                                                         
                             tensorboard_logging_steps: 500                                                                                                                    
                             use_neptune: false                                                                                                                                
                             enable_verbose_logging: false                                                                                                                     
                             enable_verbose_accelerate: true                                                                                                                   
                             enable_verbose_s3: true                                                                                                                           
                             train_subset: 1.0                                                                                                                                 
                             valid_subset: 1.0                                                                                                                                 
                             validation_interval: 100000                                                                                                                       
                             save_model: true                                                                                                                                  
                             keep_model_every_interval: false                                                                                                                  
                             save_accelerator_state: false                                                                                                                     
                             keep_accelerator_every_interval: null                                                                                                             
                             model_save_folder_path: tests/instanovo_test_resources/train_test                                                                                 
                             checkpoint_interval: 480                                                                                                                          
                             checkpoint_metric: null                                                                                                                           
                             checkpoint_metric_mode: null                                                                                                                      
                             resume_accelerator_state: null                                                                                                                    
                             resume_checkpoint_path: tests/instanovo_test_resources/model.ckpt                                                                                 
                             model:                                                                                                                                            
                               dim_model: 320                                                                                                                                  
                               n_head: 20                                                                                                                                      
                               dim_feedforward: 1280                                                                                                                           
                               encoder_layers: 9                                                                                                                               
                               decoder_layers: 9                                                                                                                               
                               dropout: 0.0                                                                                                                                    
                               use_flash_attention: false                                                                                                                      
                               conv_peak_encoder: false                                                                                                                        
                               n_peaks: 11                                                                                                                                     
                               min_mz: 1.0                                                                                                                                     
                               max_mz: 1000.0                                                                                                                                  
                               min_intensity: 0.01                                                                                                                             
                               remove_precursor_tol: 2.0                                                                                                                       
                               max_charge: 3                                                                                                                                   
                               precursor_mass_tol: 50                                                                                                                          
                               isotope_error_range:                                                                                                                            
                               - 0                                                                                                                                             
                               - 1                                                                                                                                             
                               max_length: 6                                                                                                                                   
                               peak_embedding_dtype: float64                                                                                                                   
                               n_layers: 6                                                                                                                                     
                             dataset:                                                                                                                                          
                               train_path: ./tests/instanovo_test_resources/example_data/train.mgf                                                                             
                               valid_path: null                                                                                                                                
                               valid_subset_of_train: null                                                                                                                     
                               residue_remapping: {}                                                                                                                           
                             residues:                                                                                                                                         
                               residues:                                                                                                                                       
                                 A: 10.5                                                                                                                                       
                                 B: 20.75                                                                                                                                      
                                 C: 15.68                                                                                                                                      
                                 D: 18.25                                                                                                                                      
                                 E: 12.33                                                                                                                                      
                                                                                                                                                                               
[12/05/25 14:27:55] INFO     Vocab: {0: '[PAD]', 1: '[SOS]', 2: '[EOS]', 3: 'A', 4: 'B', 5: 'C', 6: 'D', 7: 'E'}                                                               
                    INFO     Loading training dataset...                                                                                                                       
                    INFO     Loading file 001 of 001: ./tests/instanovo_test_resources/example_data/train.mgf                                                                  
[12/05/25 14:28:00] INFO     Saving temporary file to /tmp/tmph0blq53n/temp_8eb07b4c5f074304a7b3106d4225831c.parquet                                                           
                    INFO     Verifying loaded data                                                                                                                             
                    INFO     Loading validation dataset...                                                                                                                     
                    INFO     Loading file 001 of 001: ./tests/instanovo_test_resources/example_data/train.mgf                                                                  
[12/05/25 14:28:06] INFO     Saving temporary file to /tmp/tmp4o07scs2/temp_a95e10a98496478e925ce353efcd4fd7.parquet                                                           
                    INFO     Verifying loaded data                                                                                                                             
                    INFO     Validation path not specified, generating from training set.                                                                                      
                    INFO     Data splits saved to tests/instanovo_test_resources/train_test/splits.csv                                                                         
[12/05/25 14:28:07] INFO     HTTP Request: HEAD https://s3.amazonaws.com/datasets.huggingface.co/datasets/datasets/parquet/parquet.py "HTTP/1.1 404 Not Found"                 
                    INFO     Checking for unknown residues in 15,500 rows.                                                                                                     
                    INFO     Checking charge values...                                                                                                                         
                    INFO     Data loaded from 11,625 training samples and 3,875 validation samples (unfiltered values)                                                         
[12/05/25 14:28:09] INFO     Data loaders built                                                                                                                                
                    INFO     Sample batch:                                                                                                                                     
                    INFO      - spectra: torch.float32, torch.Size([32, 10, 2])                                                                                                
                    INFO      - precursors: torch.float32, torch.Size([32, 3])                                                                                                 
                    INFO      - spectra_mask: torch.bool, torch.Size([32, 10])                                                                                                 
                    INFO      - peptides: torch.int64, torch.Size([32, 7])                                                                                                     
                    INFO      - peptides_mask: torch.bool, torch.Size([32, 7])                                                                                                 
                    INFO     Setting up model...                                                                                                                               
[12/05/25 14:28:10] INFO     Model has 26,314,568 parameters                                                                                                                   
                    INFO     Resuming model state from tests/instanovo_test_resources/model.ckpt                                                                               
                    INFO     Loaded model state from tests/instanovo_test_resources/model.ckpt                                                                                 
                    INFO     TensorBoard logs will be saved to ./logs/instanovo/instanovo-unit-testinstanovo_unit_test_25_12_05_14_27                                          
                    INFO     Training setup complete.                                                                                                                          
                    INFO      - Steps per validation: 100,000                                                                                                                  
                    INFO      - Steps per checkpoint: 480                                                                                                                      
                    INFO      - Total training steps: 481                                                                                                                      
                    INFO     Estimating steps per epoch based on unfiltered training set size:                                                                                 
                    INFO      - Estimated steps per epoch: 363                                                                                                                 
                    INFO      - Estimated total epochs: 1.3                                                                                                                    
